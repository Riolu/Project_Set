<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML><HEAD><TITLE>urlscan使用详解-上海交通大学网络信息中心</TITLE>


<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<META content="" name="keywords">
<META content="" name="description"><LINK href="../../images/layout.css" type="text/css" rel="stylesheet"><LINK href="../../images/chromestyle.css" type="text/css" rel="stylesheet">

<!--Announced by Visual SiteBuilder 9-->
<link rel="stylesheet" type="text/css" href="../../_sitegray/_sitegray_d.css" />
<script language="javascript" src="../../_sitegray/_sitegray.js"></script>
<!-- CustomerNO:776562626572323074684754525b564203040000 -->
<link rel="stylesheet" type="text/css" href="../../wlaq/content.vsb.css" />
<META Name="keywords" Content="上海交通大学网络信息中心" />
<script type="text/javascript" src="../../system/resource/js/counter.js"></script>
<script type="text/javascript">_jsq_(1024,'/wlaq/content.jsp',1273,739302322)</script>
</HEAD>
<BODY><script type="text/javascript" src="../../images/chrome.js"></script>
<DIV id="container"><!-- header -->
<DIV id="top">
<DIV class="logo">
<DIV class="mlink">&nbsp;</DIV>
<DIV class="searchbox"><!--#begineditable viewid="1828" name="站内搜索"-->





<form action="../../search.jsp?wbtreeid=1024" method="post" name="a1828a" onsubmit="return subsearchdataa1828a()" style="display: inline">
  <input type="hidden" name="Find" value="find"><input type="hidden" name="entrymode" value="1"><input type="hidden" id="INTEXT2" name="INTEXT2" value=""><input type="hidden" name="news_search_code">
站内搜索&nbsp;<iframe id="intextframea1828a" src="" scrolling="no" frameborder="0" style="position:absolute;top:0px;left:0px;display:none"></iframe>
       <input class="s1" name="INTEXT">
       <input type="image" src="../../images/searchbox.png" class="s2">
</form>
<script>
function subsearchdataa1828a()
{ 
    if(checkDataa1828a(document.a1828a))
    {
       return true;  
    }
    return false;
}       
</script>

    <script> 
    function checkDataa1828a(formname)
    {
        if(window.toFF==1)
            {
                var ssvalue = a1828a.INTEXT.value;
                document.a1828a.INTEXT2.value = base64.encode(Simplized(ssvalue));
            }else
            document.a1828a.INTEXT2.value = base64.encode(document.a1828a.INTEXT.value);
           return true;
    }
    </script>
<script language="javascript" src="../../system/resource/js/base64.js"></script> 
<!--#endeditable--></DIV></DIV>
<DIV class="bn">
<DIV class="banner">
<DIV class="mlink"><!--#begineditable viewid="1826" name="首页左上链接"--><script language="javascript" src="../../system/resource/js/dynclicks.js"></script><script language="javascript" src="../../system/resource/js/openlink.js"></script>    <a href="../../web_en/index_en.htm" target="_blank" title="" onclick="_addDynClicks(&#34;wburl&#34;, 739302322, 1808)">[English Version]</a>
<!--#endeditable--></DIV>


</DIV>
<DIV class="navi chromestyle" id="chromemenu"><!--#begineditable viewid="1785" name="网站主导航"--><a href="../../index.jsp" class="navi1" onmouseover="this.className='navi1-1'" onmouseout="this.className='navi1'" onclick="blur()"></a>
<a href="../../zxgk.htm" rel="dropmenu2" class="navi2" onmouseover="this.className='navi2-1'" onmouseout="this.className='navi2'" onclick="blur()"></a>
<a href="../../gzzd.htm" rel="dropmenu3" class="navi3" onmouseover="this.className='navi3-1'" onmouseout="this.className='navi3'" onclick="blur()"></a>
<a href="../../wlfw.htm" rel="dropmenu4" class="navi4" onmouseover="this.className='navi4-1'" onmouseout="this.className='navi4'" onclick="blur()"></a>
<a href="../../wlaq.htm" rel="dropmenu5" class="navi5" onmouseover="this.className='navi5-1'" onmouseout="this.className='navi5'" onclick="blur()"></a>
<a href="../../yhzc.htm" rel="dropmenu6" class="navi6" onmouseover="this.className='navi6-1'" onmouseout="this.className='navi6'" onclick="blur()"></a>
<a href="../../lxwm.htm" class="navi7" onmouseover="this.className='navi7-1'" onmouseout="this.className='navi7'" onclick="blur()"></a>
<a href="../../web_en.htm" rel="dropmenu8" class="navi8" onmouseover="this.className='navi8-1'" onmouseout="this.className='navi8'" onclick="blur()"></a>
<!--#endeditable--></DIV><!-- 1st drop down menu -->
<DIV class="dropmenudiv" id="dropmenu1"></DIV>
<DIV class="dropmenudiv" id="dropmenu2"><!--#begineditable name="中心概况子栏目" viewid="1837"-->    <a href="../../zxgk/zxjj.htm" title="中心简介">中心简介</a>
    <a href="../../zxgk/xxwjj.htm" title="校园网简介">校园网简介</a>
    <a href="../../zxgk/xyxxh.htm" title="校园信息化">校园信息化</a>
<!--#endeditable--></DIV>
<DIV class="dropmenudiv" id="dropmenu3"><!--#begineditable name="规章制度子栏目" viewid="1838"-->    <a href="../../gzzd/gzzdlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1018" title="规章条例">规章条例</a>
    <a href="../../gzzd/gzzdlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1019" title="政策法规">政策法规</a>
<!--#endeditable--></DIV>
<DIV class="dropmenudiv" id="dropmenu4"><!--#begineditable name="网络服务子栏目" viewid="1839"-->    <a href="../../wlfw/wlfwlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1022" title="统一身份认证">统一身份认证</a>
    <a href="../../wlfw/wlfwlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1021" title="电子邮件">电子邮件</a>
    <a href="../../wlfw/wlfwlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1044" title="无线网">无线网</a>
    <a href="../../wlfw/wlfwlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1040" title="VPN">VPN</a>
    <a href="../../wlfw/wlfwlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1039" title="校园一卡通">校园一卡通</a>
    <a href="../../wlfw/wlfwlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1042" title="学生宿舍网络">学生宿舍网络</a>
    <a href="../../wlfw/wlfwlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1041" title="个人网络存储">个人网络存储</a>
    <a href="../../wlfw/wlfwlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1038" title="虚拟主机">虚拟主机</a>
    <a href="../../wlfw/wlfwlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1043" title="校园网">校园网</a>
    <a href="../../wlfw/wlfwlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1045" title="校内代理">校内代理</a>
    <a href="../../wlfw/wlfwlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1046" title="网络短信平台">网络短信平台</a>
    <a href="../../wlfw/wlfwlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1047" title="微软校园软件正版化">微软校园软件正版化</a>
    <a href="../../wlfw/wlfwlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1049" title="网络会议和视频转播">网络会议和视频转播</a>
<!--#endeditable--></DIV>
<DIV class="dropmenudiv" id="dropmenu5"><!--#begineditable name="网络安全子栏目" viewid="1840"--><a href="../../wlaq/wlaqlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1024" title="安全建议">安全建议</a>
<a href="../../wlaq/wlaqlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1026" title="安全事件通告">安全事件通告</a>
<a href="http://windowsupdate.sjtu.edu.cn" target="_blank" title="自动更新服务">自动更新服务</a>
<a href="http://antivirus.sjtu.edu.cn" target="_blank" title="防病毒服务">防病毒服务</a>
<!--#endeditable--></DIV>
<DIV class="dropmenudiv" id="dropmenu6"><!--#begineditable name="用户支持子栏目" viewid="1841"-->    <a href="../../yhzc/yhzclist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1098" title="校园网运行状态">校园网运行状态</a>
    <a href="../../yhzc/yhzclist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1029" title="常用设置">常用设置</a>
    <a href="../../yhzc/yhzclist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1030" title="用户指南">用户指南</a>
    <a href="../../yhzc/yhzclist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1031" title="文档下载">文档下载</a>
<!--#endeditable--></DIV>
<DIV class="dropmenudiv" id="dropmenu7"></DIV>
<DIV class="dropmenudiv" id="dropmenu8"></DIV>

</DIV>
<DIV style="clear: both"></DIV></DIV><script type="text/javascript">

cssdropdown.startchrome("chromemenu")

</script><!-- header end --><!-- main -->
<DIV id="main"><!-- main left -->
<DIV class="ln">
<DIV class="mailloginform">
<DIV class="mtitle64"></DIV>
<DIV class="mtxt">
<UL class="hl"><!--#begineditable viewid="1861" name="网络安全左边导航"-->    <li><div class="pt4"><a href="../../wlaq/wlaqlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1024" title="安全建议">安全建议</a></div></li>
    <li><div class="pt4"><a href="../../wlaq/wlaqlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1026" title="安全事件通告">安全事件通告</a></div></li>
    <li><div class="pt4"><a href="http://windowsupdate.sjtu.edu.cn" target="_blank" title="自动更新服务">自动更新服务</a></div></li>
    <li><div class="pt4"><a href="http://antivirus.sjtu.edu.cn" target="_blank" title="防病毒服务">防病毒服务</a></div></li>
<!--#endeditable--></UL></DIV>
<DIV style="clear: both"></DIV>
<DIV class="n1"></DIV>
<DIV class="n2"></DIV>
<DIV class="lititle"></DIV>
<DIV class="hotlink">
<UL class="hl">
<LI>
<DIV class="pt4"><A href="http://cert1.sjtu.edu.cn" target="_blank">安全问题举报</A></DIV></LI>
<LI>
<DIV class="pt4"><A href="http://bbs.sjtu.edu.cn/bbsdoc?board=SJTUnet" target="_blank">讨论交流</A></DIV></LI></UL></DIV></DIV></DIV><!-- main left end --><!-- main right -->
<DIV class="rn"><!-- main right top -->
<DIV class="htmc"></DIV><!-- location -->
<DIV class="htlocation">
<DIV id="position"><!--#begineditable viewid="1784" name="当前位置"-->  
<a href="../../index.jsp">首页</a><a href="../../wlaq.htm">网络安全</a><a href="../../wlaq/wlaqlist.jsp?urltype=tree.TreeTempUrl&wbtreeid=1024">安全建议</a>正文<!--#endeditable--></DIV></DIV><!-- location end --><!-- main right top end --><!-- main right body -->
<DIV class="hm">
<DIV style="clear: both"></DIV>
<DIV class="maintxt"><!--#begineditable viewid="1858" name="文章内容"--><script language="javascript" src="../../_dwr/interface/NewsvoteDWR.js"></script><script language="javascript" src="../../_dwr/engine.js"></script><script language="javascript" src="../../system/resource/js/news/newscontent.js"></script><script language="javascript" src="../../system/resource/js/ajax.js"></script><style type="text/css">
     .tpcontent{FONT-WEIGHT: bold; FONT-SIZE: 11pt; COLOR: #2b2b2b; FONT-FAMILY: 宋体;}
     .cytpstyle{FONT-SIZE: 9pt; COLOR: #2b2b2b; FONT-FAMILY: 宋体;}
     .content{margin:auto;text-align:left;line-height:18px;padding:3px 0 0 0;color:#727272;}
     .process{width:162px;height:11px;background:#EDEDED;overflow:hidden;float:left;margin-left:26px !important;margin-left:13px;margin-right:10px;}
     .process div{width:160px;height:11px;background:url(../../system/resource/images/newsvote/bg.gif) repeat-x;border-left:1px solid #000;border-right:1px solid #000;}
     .process .style7{border-left-color:#ff0000;border-right-color:#ff0000;background-position:0 -77px;}
</style>
<form name="_newscontent_fromname">
<div>
    <p id="text-strong">urlscan使用详解</p>
    <div align="center">2010-11-06&nbsp;firstonline&nbsp;点击：[<script>_showDynClicks("wbnews", 739302322, 1273)</script>] </div>
    <hr>
    <div><table width="95%" border="0" cellpadding="1" cellspacing="1" bgcolor="#3366cc">

      <tr>
        <td align="top" background="http://comic.sjtu.edu.cn/bbs/" bgcolor="#EFEFEF" class="text">
         <table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr>
           <td width="96%" class="smText" align="center">本文由 <a href="mailto:firstonline@sjtu.edu.cn">firstonline</a> 于2007 1月 18 at 8:17am
		    发表，已被阅读 16992 次</td>
          </tr>
         </table>

<P>（一）、软件的下载与安装<BR><BR>URLScan可以在微软的网站上下载，地址如下：<BR><A href="http://www.microsoft.com/downloads/details.aspx?FamilyID=23d18937-dd7e-4613-9928-7f94ef1c902a&DisplayLang=en" target="_blank">http://www.microsoft.com/downloads/details.aspx?FamilyID=23d18937-dd7e-4613-9928-7f94ef1c902a&amp;DisplayLang=en</A><BR><BR>和一般软件一样安装，但是，此软件不能选择安装路径，安装完成以后，我们可以在System32/InetSvr/URLScan目录下找到以下文件：<BR><BR>urlscan.dll：动态连接库文件；<BR>urlscan.inf：安装信息文件；<BR>urlscan.txt：软件说明文件；<BR>urlscan.ini：软件配置文件，这个文件很只要，因为对URLScan的所有配置，均有这个文件来完成。<BR><BR>（二）、软件的配置<BR><BR>软件的配置由urlscan.ini文件来完成，在配置此文件以前，我们需要了解一些基本知识。<BR><BR>１、urlscan配置文件的构造形式<BR><BR>urlscan配置文件必须遵从以下规则：<BR><BR>（1）此文件名必须为urlscan.ini；<BR><BR>（2）配置文件必须和urlscan.dll在同一目录；<BR><BR>（3）配置文件必须是标准ini文件结构，也就是由节，串和值组成；<BR><BR>（4）配置文件修改以后，必须重新启动IIS，使配置生效；<BR><BR>（5）配置文件由以下各节组成：<BR><BR>[Option]节，主要设置节；<BR>[AllowVerbs]节，配置认定为合法URL规则设定，此设定与Option节有关；<BR>[DenyVerbs]节，配置认定为非法URL规则设定，此设定与Option节有关；<BR>[DenyHeaders]节，配置认定为非法的header在设立设置；<BR>[AllowExtensions]节，配置认定为合法的文件扩展名在这里设置，此设定与Option节有关；<BR>[DenyExtensions]节，配置认定为非法的文件扩展名在这里设置，此设定与Option节有关；<BR><BR>２、具体配置<BR><BR>（1）Option节的配置，因为Option节的设置直接影响到以后的配置，因此，这一节的设置特别重要。此节主要进行以下属性的设置：<BR><BR>UseAllowVerbs：使用允许模式检查URL请求，如果设置为1,所有没有在[AllowVerbs]节设置的请求都被拒绝；如果设置为0，所有没有在[DenyVerbs]设置的URL请求都认为合法；默认为1;<BR><BR>UseAllowExtensions：使用允许模式检测文件扩展名；如果设置为 1,所有没在[AllowExtensions]节设置的文件扩展名均认为是非法请求；如果设置为0,所有没在[DenyExtensions]节设置的扩展名均被认为是合法请求；默认为0;<BR><BR>EnableLogging：是否允许使用Log文件，如果为1,将在urlscan.dll的相同目录设置名为urlscan.log的文件记录所有过滤；<BR><BR>AllowLateScanning：允许其他URL过滤在URLScan过滤之前进行，系统默认为不允许0;<BR><BR>AlternateServerName：使用服务名代替；如果此节存在而且[RemoveServerHeader]节设置为0,IIS将在这里设置的服务器名代替默认的“Server”；<BR><BR>NormalizeUrlBeforeScan：在检测URL之前规格化URL；如果为1，URLScan将在IIS编码URL之前URL进行检测；需要提醒的是，只有管理员对URL解析非常熟悉的情况下才可以将其设置为0；默认为1；<BR><BR>VerifyNormalization：如果设置为1，UrlScan将校验URL规则，默认为1；此节设定与NormalizeUrlBeforeScan有关；<BR><BR>AllowHighBitCharacters：如果设置为1,将允许URL中存在所有字节，如果为0，含有非ASCII字符的URL将拒绝；默认为1；<BR><BR>AllowDotInPath：如果设置为1，将拒绝所有含有多个“.”的URL请求，由于URL检测在IIS解析URL之前，所以，对这一检测的准确性不能保证，默认为0；<BR><BR>RemoveServerHeader：如果设置为1，将把所有应答的服务头清除，默认为0;<BR><BR>（2）[AllowVerbs]节配置<BR><BR>如果UseAllowVerbs设置为1,此节设置的所有请求将被允许，一般设置以下请求：<BR><BR>GET、HEAD、POST<BR><BR>（3）[DenyVerbs]节配置<BR><BR>如果UseAllowVerbs设置为0，此节设置的所有请求将拒绝，一般设置以下请求：<BR><BR>PROPFIND、PROPPATCH、MKCOL、DELETE、PUT、COPY、MOVE、LOCK、UNLOCK<BR><BR>（4）[AllowExtensions]节设置<BR><BR>在这一节设置的所有扩展名文件将被允许请求，一般设置以下请求：<BR><BR>.asp、.htm、.html、.txt、.jpg、.jpeg、.gif，如果需要提供文件下载服务，需要增加.rar、.zip<BR><BR>（5）[DenyExtensions]节设置<BR><BR>在这一节设置的所有扩展名文件请求将被拒绝，根据已经发现的漏洞，我们可以在这一节增加内容，一般为以下设置：<BR>.asa、可执行文件、批处理文件、日志文件、罕见扩展如：shtml、.printer等。 <BR><FONT color="red">具体</FONT><FONT color="red">设置，应当视具体应用情况而定，否则会造成应用服务无法运行。譬如禁掉shtml，某些仿新浪的文章系统就无法运行了。另安上ASP.NET 2.0，然后数据库扩展名改成MDB，就不用怕被下载了。[感谢sunny boy的建议和支持]</FONT></P>
<P> </P><edited><editID>firstonline</editID><editDate>39140.6246180556</editDate></edited>

        </td>
       </tr>
</table></div><div id="div_vote_id"></div>
    <p align="right">
        上一条：<a href="1274.htm">跨站&amp;#083;cript攻击和防范</a>
        下一条：<a href="1272.htm">网络安全从我做起</a>
    </p>
    <p align="right">【<a href="javascript:window.opener=null;window.open('','_self');window.close();">关闭</a>】</p>
</div>
</from>
<script>
    showVote(1273,739302322,"#F3F7FA"," class='cytpstyle' ","#090909","<img src ='/system/resource/images/newsvote/ss00.png' border='0'>"," class='tpcontent' ","欢迎参与投票",10,"<img src='/system/resource/images/newsvote/submit2.gif' onclick='_newscontent_getresult(1273,739302322)'  style='cursor:hand;'>","<img src='/system/resource/images/newsvote/view2.gif' onclick='_newscontent_lookresult()' style='cursor:hand;'>",document._newscontent_fromname,"请填写投票项！","127.0.0.1","您已经投过票了！","投票系统出现异常，请稍后再试！","感谢参与！","投票结果")
</script><!--#endeditable-->
<FORM name="_newscontent_fromname"></DIV>
<DIV style="clear: both"></DIV></DIV>
<DIV style="clear: both"></DIV><!-- main right body end --></DIV><!-- main right end --></DIV><!-- main end -->
<DIV class="k"></DIV><!-- footer -->
<DIV id="footer">
<DIV class="link" style="display: none">友情链接：<SELECT class="s3" name="link" onchange="javascript:window.open(this.options[this.selectedIndex].value)"> <OPTION value="" selected>&nbsp;&nbsp;</OPTION> <OPTION value="http://www.sjtu.edu.cn">上海交通大学</OPTION> <OPTION value="http://www.edu.cn">中国教育和科研网</OPTION> <OPTION value="http://www.cdream.com/">校园梦网</OPTION></SELECT> </DIV>
<DIV class="cp"><!--#begineditable viewid="1825" name="版权"--><P>2004-2013 上海交通大学网络中心 版权所有 <FONT color="#2c678d">沪交ICP备05069</FONT></P><!--#endeditable--></DIV></DIV><!-- footer end --></DIV>

</FORM></BODY></HTML>

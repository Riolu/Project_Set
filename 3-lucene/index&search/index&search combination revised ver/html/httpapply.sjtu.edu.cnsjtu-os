<!DOCTYPE html system "about:legacy-compat">
<html>
	<head>
				<meta content="text/html; charset=utf-8" http-equiv="content-Type"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Cache-Control" content="no-cache"><meta http-equiv="Expires" content="0"><meta http-equiv="imagetoolbar" content="no">
		<link href="favicon.ico" rel="Shortcut Icon" />
		<link rel="stylesheet" type="text/css" href="css/style.css">
		<title>上海交通大学::留学生发展中心::留学生在线报名-ShangHai JiaoTong University::ISC::Apply</title>

		<style>
#tbl{border-collpase:collpase;width:303px;}
#tbl td{font-size:13px;width:100px;white-space:nowrap;padding:8px 5px;vertical-align:middle;}
#tbl td input{border:solid 1px #666;width:175px;height:26px;padding:2px 0 0 3px}
#tbl td.fld{width:99px;text-align:right;font-size:12px}
		</style>
	</head>
<body>
<div id="header">
	<div class="header">
		<span class="txt-zn">留学生信息管理系统</span><br/>
		<span class="txt-en">Foreign Students Information Management System</span>
	</div>
	<div class="top-link">
		<a href="http://isc.sjtu.edu.cn/contact_us.html" target="_blank">Contact Us</a>
	</div>
</div>
<div id="top-line"></div>

<div id="main">
	<div class="main" style="padding:20px 0 0 100px;">		
		<div id="tbl_bg" style="float:left;width:305px;height:300px;background-image:url(images/w3/login.png);">
			<form id="fm" onsubmit="return false;">
				<div style="width:310px;height:400px;padding:4px 0 0 2px;">		
					<table id="tbl" cellspacing="1" cellpadding="0">					
						<tr>
							<td colspan="2" onClick="switchPad('change');" style="text-align:center;width:140px;height:30px;cursor:pointer;"><span>修改密码<br/>Change Password</span></td>
							<td colspan="2" onClick="switchPad('login');" style="text-align:center;width:140px;height:30px;cursor:pointer;"><span>登录<br/>Sign In</span></td>
						</tr>
						<tr>
							<td class="fld"><div class="zh">学校学号</div><div class="en">Student No.</div></td>
							<td colspan="3"><input id="account" name="account" type="text"/></td>
						</tr>
						<tr id="pad_pwd">
							<td class="fld"><div class="zh">密码</div><div class="en">Password</div></td>
							<td colspan="3" ><input id="password" name="password" type="password" class="validate[required, funcCall[ckPassword]]"/></td>
						</tr>				
						<tr id="ver_code">
							<td class="fld"><div class="zh">验证码</div><div class="en">Verification code</div></td>
							<td colspan="3" ><input id="verification_code" name="verification_code" type="text" style="width:100px;"/>
								<img src="img.asp?k=8UyMacbgx7NbgCA3nTHL6C9MO7zPRyVU5zMVFKUOLxWSTlyrxfldJNc1CUfUIXln&t=2015/10/28%2014%3A29%3A11" border="0" id="vc" style="height:30px;width:70px;" onClick="chCode()" align="absmiddle" /><input type="hidden" id="token" name="token" value="8UyMacbgx7NbgCA3nTHL6C9MO7zPRyVU5zMVFKUOLxWSTlyrxfldJNc1CUfUIXln" />	
							</td>
						</tr>
						<tr id="old_pwd" style="display:none;">
							<td class="fld"><div class="zh">原密码</div><div class="en">Origen Password</div></td>
							<td colspan="3"><input type="password" id="oldpwd" name="oldpwd" maxlength="20"/></td>
						</tr>
						<tr id="new_pwd" style="display:none;">
							<td class="fld"><div class="zh">新密码</div><div class="en">New Password</div></td>
							<td colspan="3"><input type="password" id="newpwd" name="newpwd" maxlength="20"/></td>
						</tr>
						<tr id="con_pwd" style="display:none;">
							<td class="fld"><div class="zh">确认密码</div><div class="en">Confirm Password</div></td>
							<td colspan="3"><input type="password" id="conpwd" name="conpwd" maxlength="20" onblur="checkPassword();"/></td>
						</tr>
						<tr id="btn_login">
							<td colspan="4" style="padding-left:80px;"><div class="buttonview_new" style="text-align:center;" onClick="javascript:doSubmit();void(0);">登录/Login</div></td>
						</tr>
						<tr id="btn_change" style="display:none;">
							<td colspan="4" style="padding-left:80px;"><div class="buttonview_new" style="text-align:center;" onClick="javascript:doSubmit();void(0);">修改/Change</div></td>
						</tr>
						<tr id="btn_fetch" style="display:none;">
							<td colspan="4" style="padding-left:80px;"><div class="buttonview_new" style="text-align:center;" onClick="javascript:doSubmit();void(0);">重置密码/Reset Password</div></td>
						</tr>
						<tr>
							<td colspan="4" style="padding:20px 0 0 20px;"><a href="javascript:switchPad('fetch');void(0);" class="lnk">重置密码 reset your passord</a></td>
						</tr>
					</table>			
				</div>
			</form>
		</div>
		<div style="float:left;padding:20px;width:510px;height:310px;background:url(images/w3/t3.jpg) no-repeat 30px 0"></div>	
		<div class="clr"></div>
		为了获得更好的浏览效果，建议您使用IE7.0及以上版本浏览器或谷歌Chrome浏览器登陆本站点<br/>
		For better browsing effects. Please use ie7.0 or above or google Chrome to surf this website.<br/><br/>
		<iframe name="hf" id="hf" width="700" height="200" style="display:none;" src=""></iframe>
	</div>
	</div>
<div id="bottom">
	<span class="copyright">
		<a href="http://isc.sjtu.edu.cn" target="_blank">Study@SJTU</a> | 
		<a href="http://en.sjtu.edu.cn" target="_blank">SJTU Homepage</a> | 
		<a href="http://en.sjtu.edu.cn/about-sjtu/life-sjtu/accommodation/" target="_blank">Life@SJTU</a> | 
		<a href="http://global.sjtu.edu.cn" target="_blank">Global SJTU</a> | 
		<a href="http://en.study-shanghai.org/" target="_blank">Study in Shanghai</a> | 
		<a href="http://www.csc.edu.cn/laihua/index.aspx" target="_blank">Study in China</a> | 
		<a href="http://www.exploreshanghai.com/metro/" target="_blank" >Metro Map of Shanghai</a></span><br/>
	<span class="copyright">&copy;版权所有 上海交通大学 留学生发展中心</span>
</div><script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="js/site.js"></script>

<script type="text/javascript">
var aImg = [];
for(var i = 0; i<4; i++){aImg[i] = new Image();aImg[i].src = "images/w3/t_m" + (i+1) + ".gif";}
var sCur = "login";

function ckPassword(field, rules, i, options){
	var v = $.trim(field.val());
	field.val(v);
	var re = /^[\s\S]{6,16}$/;
	if(!re.test(v)) return "* 密码应在6-16个字符之间 (The length of password is between 6 to 16 chars)";
	return ;
}
function doSubmit(){
	switch(sCur){
		case 'login':
			doLogin();
			break;
		case 'change':
			doChange();
			break;	
		case 'fetch':
			doFetch();
			break;	
	}
}
function chCode(){$("codekey").value='';hf.location.replace("get_token.asp");}
function doLogin(){
	var b = $("#fm").validationEngine('validate');
	if(!b) return false;
	showMask();
	$.ajax({
		url:'c.asp?action=student_login',
		cache:false,
		type:'POST',
		data:{account:$('#account').val(),password:$('#password').val(),code:$('#verification_code').val(),token:$('#token').val()},
		error:function(xhr, status, err){
			showErr(err);
			hideMask();
		},	
		success:function(data, status, err){
			var obj = eval("("+data+")");		
			hideMask();
			switch(obj.state){
				case '0':
					location.replace('c.asp?action=student_main_en');
					break;
				case '1':
					showErr("请30秒后再登录。<br>Please sign in after 30 seconds.");
					break;
				case '3':
					showErr("账户不存在。<br>Your account does not exist.");
					break;
				default:
					chCode();
					showErr(obj.msg);
			}
		}
	});
}
function doChange(){
	var b = $("#fm").validationEngine('validate');
	if(!b) return false;
	showMask();
	$.ajax({
		url:'c.asp?action=student_pwdmod',
		cache:false,
		type:'POST',
		data:{account:$("#account").val(),oldpwd:$('#oldpwd').val(),newpwd:$('#newpwd').val()},
		error:function(xhr, status, err){
			showErr(err);
			hideMask();
		},
		success:function(data, status, err){
			var obj = eval("(" + data + ")");
			hideMask();
			switch(obj.state){
				case '0':
					showInfo("成功修改密码。<br>Your password has changed.");
					break;
				case '1':
					showErr("修改失败。<br>Operation failed.");
					break;
				default:
					showErr(obj.msg);
			}
		}
	});
}
function doFetch(){
	var b = $("#fm").validationEngine('validate');
	if(!b) return false;
	showMask();
	$.ajax({
		url:'c.asp?action=student_pwdreset',
		cache:false,
		type:'POST',
		data:{account:$("#account").val()},
		error:function(xhr, status, err){
			showErr(err);
			hideMask();
		},
		success:function(data, status, err){
			var obj = eval("(" + data + ")");
			hideMask();
			switch(obj.state){
				case '0':
					showInfo("您的密码已重置为护照后六位。<br>Your password reset to the last six digits of your passport number.");
					break;
				default:
					showErr(obj.msg);
			}
		}
	});
}
function switchPad(s){
	sCur = s;
	switch(s){
		case 'login':
			$("#tbl_bg").css("background-image", "url(images/w3/login.png)");
			$('#pad_pwd').show(); $('#btn_login').show(); $('#ver_code').show(); $('#btn_change').hide();
			$('#old_pwd').hide();	$('#new_pwd').hide();	$('#con_pwd').hide(); $('#btn_fetch').hide();
			break;
		case 'change':
			$("#tbl_bg").css("background-image", "url(images/w3/login_regist.png)");
			$('#pad_pwd').hide(); $('#btn_login').hide(); $('#ver_code').hide(); $('#btn_change').show();
			$('#old_pwd').show();	$('#new_pwd').show();	$('#con_pwd').show(); $('#btn_fetch').hide();
			break;
		case 'fetch':
			$("#tbl_bg").css("background-image", "url(images/w3/login_regist.png)");
			$('#pad_pwd').hide(); $('#btn_login').hide(); $('#ver_code').hide(); $('#btn_change').hide();
			$('#old_pwd').hide();	$('#new_pwd').hide();	$('#con_pwd').hide(); $('#btn_fetch').show();
			break;
		}
}
function showMask(){
	$('#btn_submit').attr('disabled', true);
	$('#fm').mask("Loading...");
}
function hideMask(){
	$('#btn_submit').attr('disabled', false);
	if($('#fm').isMasked()) $('#fm').unmask();
}
function checkPassword(){
	var newPWD = $('#newpwd').val();
	var chPWD = $('#conpwd').val();
	if(newPWD!=chPWD){
		showErr("两次输入的密码不一样！请重新输入！The two passwords input are not same. Please re-enter.")
	}
}
$(function(){
	$("#fm").validationEngine({
		promptPosition:'topRight',
		autoHidePrompt:true,
		autoHideDelay:4000
	});
});
</script>

	</body>
</html>